<!DOCTYPE html>
<html lang="en" class="light-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrew B. Caldwell PhD | Research Scientist | Systems Biologist | Bioinformatics | UC San Diego</title>
    <link rel="canonical" href="https://andrewbcaldwell.com/index.html" />
    <meta name="robots" content="index, follow" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="custom.css">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;700&display=swap" as="style">
    <link rel="preload" href="custom.css" as="style">
    <link rel="preload" href="images/profile.jpg" as="image">
    <meta name="description" content="Andrew B. Caldwell, Systems Biologist at UC San Diego researching Alzheimer's Disease through computational and experimental approaches.">
    <meta name="keywords" content="systems biology computational biology, Alzheimer's disease, Neurodevelopment, Andrew Caldwell, UC San Diego">
    <meta name="author" content="Andrew B. Caldwell">
    <meta property="og:title" content="Andrew B. Caldwell - Systems Biologist">
    <meta property="og:description" content="From cell culture to code, translating complex data into meaningful biological insights.">
    <meta property="og:image" content="https://andrewbcaldwell.com/images/profile.jpg">
    <meta property="og:url" content="https://andrewbcaldwell.com">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@AndrewBCaldwell">
    <meta name="twitter:title" content="Andrew B. Caldwell - Systems Biologist">
    <meta name="twitter:description" content="From cell culture to code, translating complex data into meaningful biological insights.">
    <meta name="twitter:image" content="https://andrewbcaldwell.com/images/profile.jpg">
     <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Andrew B. Caldwell",
      "jobTitle": "Research Scientist, Systems Biology",
      "affiliation": {
        "@type": "Organization",
        "name": "UC San Diego",
        "url": "https://ucsd.edu/"
      },
      "url": "https://andrewbcaldwell.com",
      "sameAs": [
        "https://www.linkedin.com/in/andrewbcaldwell/",
        "https://scholar.google.com/citations?hl=en&user=yZdrmZoAAAAJ",
        "https://orcid.org/0000-0002-2850-7677",
        "https://github.com/andrewbcaldwell"
      ],
      "knowsAbout": ["Systems Biology", "Alzheimer's Disease", "Multiomics", "Computational Biology"],
      "workLocation": {
        "@type": "Place",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "9500 Gilman Drive",
          "addressLocality": "La Jolla",
          "addressRegion": "CA",
          "postalCode": "92093",
          "addressCountry": "USA"
        }
      },
      "workExample": [
        {
          "@type": "ScholarlyArticle",
          "headline": "Integrative multiomics reveals common endotypes across PSEN1, PSEN2, and APP mutations in familial Alzheimer's disease",
          "author": [
            {
              "@type": "Person",
              "name": "Andrew B. Caldwell"
            }
          ],
          "datePublished": "2025",
          "isAccessibleForFree": true,
          "url": "https://doi.org/10.1186/s13195-024-01659-6",
          "publisher": {
            "@type": "Organization",
            "name": "Alzheimer's Research & Therapy"
          },
          "description": "Study examining common molecular patterns across different genetic mutations in familial Alzheimer's disease",
          "keywords": "Alzheimer's disease, multiomics, PSEN1, PSEN2, APP, endotypes"
        },
        {
          "@type": "ScholarlyArticle",
          "headline": "Dedifferentiation and neuronal repression define familial Alzheimer's disease",
          "author": [
            {
              "@type": "Person",
              "name": "Andrew B. Caldwell"
            }
          ],
          "datePublished": "2020",
          "url": "https://advances.sciencemag.org/content/6/46/eaba5933",
          "publisher": {
            "@type": "Organization",
            "name": "Science Advances"
          },
          "identifier": {
            "@type": "PropertyValue",
            "propertyID": "DOI",
            "value": "10.1126/sciadv.aba5933"
          },
          "description": "Research on cellular mechanisms underlying familial Alzheimer's disease",
          "keywords": "Alzheimer's disease, dedifferentiation, neuronal repression"
        }
      ],
      "email": "andrewbcaldwell@gmail.com"
    }
    </script>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#4338CA">
</head>
<body>
    <nav class="navbar is-fixed-top main-navbar" role="navigation" aria-label="main navigation">
        <div class="container">
            <div class="navbar-brand">
                <a class="navbar-item brand-name" href="index.html">
                    <span class="logo-icon"><i class="fas fa-dna"></i></span> Andrew B. Caldwell
                </a>

                <div class="navbar-item has-dropdown mobile-theme-toggler" id="mobile-theme-dropdown-container">
                    <a class="navbar-link is-arrowless mobile-theme-trigger" id="mobile-theme-trigger" aria-label="theme options" aria-haspopup="true" aria-expanded="false">
                        <span class="icon">
                            <i class="fas fa-cog"></i> </span>
                    </a>
                    <div class="navbar-dropdown" id="mobile-theme-options-dropdown"> <div class="theme-item" data-theme="light">
                            <span class="theme-icon sun"><i class="fas fa-sun"></i></span>
                            <span>Light</span>
                        </div>
                        <div class="theme-item" data-theme="dark">
                            <span class="theme-icon moon"><i class="fas fa-moon"></i></span>
                            <span>Dark</span>
                        </div>
                        <div class="theme-item" data-theme="system">
                            <span class="theme-icon desktop"><i class="fas fa-desktop"></i></span>
                            <span>System</span>
                        </div>
                    </div>
                </div>

                <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="mainNavbarMobile">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
            
            <div class="navbar-menu" id="mainNavbarMobile">
                <div class="navbar-end">
                    <div class="navbar-item theme-dropdown-navbar-item"> <div class="theme-dropdown" id="desktop-theme-dropdown-container"> <button id="desktop-theme-trigger" class="button is-small" aria-label="Theme options" aria-haspopup="true" aria-expanded="false">
                                <span class="icon">
                                    <i class="fas fa-cog" id="desktop-theme-display-icon"></i> </span>
                            </button>
                            <div class="theme-dropdown-content" id="desktop-theme-options-dropdown"> <div class="theme-item" data-theme="light">
                                    <span class="theme-icon sun"><i class="fas fa-sun"></i></span>
                                    <span>Light</span>
                                </div>
                                <div class="theme-item" data-theme="dark">
                                    <span class="theme-icon moon"><i class="fas fa-moon"></i></span>
                                    <span>Dark</span>
                                </div>
                                <div class="theme-item" data-theme="system">
                                    <span class="theme-icon desktop"><i class="fas fa-desktop"></i></span>
                                    <span>System</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="navbar-item">
                        <a href="cv.html" class="button is-indigo">
                            <strong>CV</strong>
                        </a>
                    </div>
                    <div class="navbar-item">
                        <a href="mailto:andrewbcaldwell@gmail.com" class="button is-indigo">
                            <strong>Email Me</strong>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <section class="section white-intro-hero">
        <div class="container has-text-centered">
            <h1 class="title is-1 is-spaced hero-main-title">Bench-to-Code Systems Biologist</h1>
            <p class="subtitle is-4 hero-tagline">From cell culture to code, I translate complex data into meaningful biological insights.</p>
            <div class="white-hero-profile-image-wrapper">
                <img src="images/profile.jpg" alt="Andrew B. Caldwell, Systems Biologist specializing in Alzheimer's Disease research" width="256" height="256" class="hero-profile-image-main is-rounded">
            </div>
        </div>
    </section>

    <section class="section indigo-description-hero is-primary">
        <div class="hero-body">
            <div class="container">
                <div class="columns is-centered">
                    <div class="column is-three-quarters-desktop is-full-tablet">
                        <div itemscope itemtype="http://data-vocabulary.org/Person" class="content">
                            <h2 class="title is-2 has-text-centered">Hi, I'm Andrew.</h2>
                            <p class="is-size-5">
                                I'm a <span itemprop="title">Research Scientist</span> at UC San Diego integrating experimental biology with computational approaches to understand complex diseases.
                                I work across the full spectrum of biomedical researchâ€”designing experiments, conducting wet lab work, and performing advanced computational analyses. This end-to-end perspective allows me to bridge traditional laboratory techniques with modern data science to extract meaningful biological insights.
                            </p>
                            <p class="is-size-5">
                                My work has been published in <a href="https://advances.sciencemag.org/content/6/46/eaba5933" target="_blank" rel="noopener noreferrer" class="has-text-weight-semibold link-on-indigo-bg">Science Advances</a>, <a href="https://alz-journals.onlinelibrary.wiley.com/doi/10.1002/alz.12553" target="_blank" rel="noopener noreferrer" class="has-text-weight-semibold link-on-indigo-bg">Alzheimer's & Dementia</a>, and <a href="https://doi.org/10.1186/s13195-024-01659-6" target="_blank" rel="noopener noreferrer" class="has-text-weight-semibold link-on-indigo-bg">Alzheimer's Research & Therapy</a>, where I focus on uncovering new mechanisms in Alzheimer's Disease biogenesis.
                            </p>
                            <p class="is-size-5">
                                I'm driven by the challenge of decoding the complexities of neurodevelopment and neurodegeneration, applying systems-level thinking with deep knowledge of human biology to advance our understanding of these critical health challenges and potentially inform future therapeutic strategies.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section recent-publications-section">
        <div class="container has-text-centered">
            <h1 class="title is-1 is-spaced hero-main-title">Recent Publications</h1>
            
            <div class="columns is-multiline is-centered">
                <div class="column is-one-third-desktop is-half-tablet">
                    <article class="publication-item">
                        <a href="https://doi.org/10.1186/s13195-024-01659-6" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure"> 
                                <img src="images/pub_portrait_valdes2025.jpg" alt="Research on common patterns across genetic mutations in familial Alzheimer's disease" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">Integrative multiomics reveals common endotypes across PSEN1, PSEN2, and APP mutations...</h3>
                                <p class="publication-journal">Alzheimer's Research & Therapy (2025)</p>
                            </div>
                        </a>
                    </article>
                </div>
                <div class="column is-one-third-desktop is-half-tablet">
                    <article class="publication-item">
                        <a href="https://alz-journals.onlinelibrary.wiley.com/doi/10.1002/alz.12553" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure">
                                <img src="images/pub_portrait_caldwell2022_alzdem.jpg" alt="Endotype reversal strategy for screening drugs targeting familial Alzheimer's disease" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">Endotype reversal as a novel strategy for screening drugs targeting familial Alzheimer's disease.</h3>
                                <p class="publication-journal">Alzheimer's & Dementia (2022)</p>
                            </div>
                        </a>
                    </article>
                </div>
                <div class="column is-one-third-desktop is-half-tablet">
                     <article class="publication-item">  
                        <a href="https://www.science.org/doi/10.1126/sciadv.aba5933" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure">
                                <img src="images/pub_portrait_caldwell2020.jpg" alt="Dedifferentiation and neuronal repression in familial Alzheimer's disease research" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">Dedifferentiation and neuronal repression define familial Alzheimer's disease.</h3>
                                <p class="publication-journal">Science Advances (2020)</p>
                            </div>
                        </a>
                    </article>
                </div>
                <div class="column is-one-third-desktop is-half-tablet">
                    <article class="publication-item">
                        <a href="https://doi.org/10.1186/s13041-022-00963-2" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure">
                                 <img src="images/pub_portrait_caldwell2022_molbrain.jpg" alt="Transcriptomic profiling of sporadic Alzheimer's disease patients research" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">Transcriptomic profiling of sporadic Alzheimer's disease patients.</h3>
                                <p class="publication-journal">Molecular Brain (2022)</p>
                            </div>
                        </a>
                    </article>
                </div>
                <div class="column is-one-third-desktop is-half-tablet">
                    <article class="publication-item">
                        <a href="https://doi.org/10.1038/s41398-023-02397-3" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure">
                                 <img src="images/pub_portrait_dwivedi2023.jpg" alt="Methadone's effects on transcriptional programs in human cortical organoids" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">Methadone alters transcriptional programs associated with synapse formation in human cortical organoids.</h3>
                                <p class="publication-journal">Translational Psychiatry (2023)</p>
                            </div>
                        </a>
                    </article>
                </div>
                 <div class="column is-one-third-desktop is-half-tablet">
                    <article class="publication-item">
                        <a href="https://doi.org/10.1038/s12276-022-00769-1" target="_blank" rel="noopener noreferrer" class="publication-card portrait">
                            <figure class="image publication-image-figure">
                                <img src="images/pub_portrait_azad2022.jpg" alt="ARID1B research on molecular suppression of erythropoiesis and Monge's disease" loading="lazy" width="300" height="400">
                            </figure>
                            <div class="publication-overlay">
                                <h3 class="title is-5">ARID1B, a molecular suppressor of erythropoiesis, is essential for the prevention of Monge's disease.</h3>
                                <p class="publication-journal">Experimental & Molecular Medicine (2022)</p>
                            </div>
                        </a>
                    </article>
                </div>
            </div>
            
            <div class="mt-5 mb-5">
                <a href="https://scholar.google.com/citations?hl=en&user=yZdrmZoAAAAJ&view_op=list_works&authuser=1" class="button is-primary is-large is-rounded" target="_blank" rel="noopener noreferrer">
                    <span class="icon"><i class="fas fa-graduation-cap"></i></span>
                    <span>More on Google Scholar</span>
                </a>
            </div>
        </div>
    </section>

    <section class="section white-collab-section" style="padding-bottom: 3rem;">
        <div class="container has-text-centered">
            <h1 class="title is-1 is-spaced hero-main-title">Interested in collaborating with me?</h1>
            <p class="subtitle is-4 hero-tagline">I'm always open to discussing new projects, research collaborations, or interesting opportunities.</p>
            <div class="mt-5">
                <a href="mailto:andrewbcaldwell@gmail.com" class="button is-primary is-large is-rounded">
                    <span class="icon"><i class="fas fa-envelope"></i></span>
                    <span>Let's talk</span>
                </a>
            </div>
        </div>
    </section>

    <footer class="footer section indigo-description-hero is-primary" style="padding: 2rem 1.5rem; color: white !important;">
        <div class="container">
            <h3 class="title is-3 has-text-centered mb-3" style="color: white !important;">Find Me Online</h3>
            <div class="has-text-centered mb-4"> 
                <div class="hero-social-links field is-grouped is-grouped-centered">
                    <p class="control">
                        <a href="https://www.linkedin.com/in/andrewbcaldwell/" title="LinkedIn" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fa-brands fa-linkedin-in"></i></span>
                        </a>
                    </p>
                    <p class="control">
                        <a href="https://scholar.google.com/citations?hl=en&user=yZdrmZoAAAAJ&view_op=list_works&authuser=1" title="Google Scholar" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fa-brands fa-google-scholar"></i></span>
                        </a>
                    </p>
                    <p class="control">
                    <a href="https://orcid.org/0000-0002-2850-7677" title="ORCID (0000-0002-2850-7677)" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                        <span class="icon"><i class="fab fa-orcid"></i></span>
                    </a>
                    </p>
                    <p class="control">
                        <a href="https://www.researchgate.net/profile/Andrew_Caldwell2" title="ResearchGate" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fab fa-researchgate"></i></span>
                        </a>
                    </p>
                    <p class="control">
                        <a href="https://github.com/andrewbcaldwell" title="GitHub" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fab fa-github"></i></span>
                        </a>
                    </p>
                    <p class="control">
                        <a href="https://www.twitter.com/AndrewBCaldwell" title="X (Twitter)" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fab fa-x-twitter"></i></span>
                        </a>
                    </p>
                    <p class="control">
                        <a href="https://bsky.app/profile/andrewbcaldwell.bsky.social" title="Bluesky" target="_blank" rel="noopener noreferrer" class="button is-ghost" style="color: white;">
                            <span class="icon"><i class="fa-solid fa-cloud"></i></span>
                        </a>
                    </p>
                </div>
            </div>
            <div style="display: flex; justify-content: center; align-items: center;"> 
                <p style="margin: 0; color: white !important;"> 
                    Built with
                    <a href="https://bulma.io" target="_blank" rel="noopener noreferrer" class="bulma-credit" style="color: white !important;">
                    <img src="images/bulma-logo.svg" alt="Bulma CSS Framework" class="bulma-logo-img" style="filter: brightness(0) invert(1);">
                    </a>
                    by me &copy; <span id="current-year"></span>
                </p>
            </div>
        </div>
    </footer>

    <script>
        if(document.getElementById('current-year')) {
            document.getElementById('current-year').textContent = new Date().getFullYear();
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Navbar burger toggle
            const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
            if ($navbarBurgers.length > 0) {
                $navbarBurgers.forEach(el => {
                    el.addEventListener('click', () => {
                        const targetId = el.dataset.target;
                        const $target = document.getElementById(targetId);
                        el.classList.toggle('is-active');
                        $target.classList.toggle('is-active');
                    });
                });
            }
            
            // Navbar shadow on scroll
            const mainNavbar = document.querySelector('.main-navbar');
            if (mainNavbar) {
                const scrollThreshold = 10; 
                const addShadow = () => mainNavbar.classList.add('has-shadow');
                const removeShadow = () => mainNavbar.classList.remove('has-shadow');
                if (window.scrollY > scrollThreshold) { addShadow(); } else { removeShadow(); }
                window.addEventListener('scroll', () => {
                    if (window.scrollY > scrollThreshold) { addShadow(); } else { removeShadow(); }
                });
            }

            // --- Theme Toggle Logic ---
            const allThemeItems = document.querySelectorAll('.theme-item');

            // Desktop theme dropdown elements
            const desktopThemeDropdownContainer = document.getElementById('desktop-theme-dropdown-container'); // This is the .theme-dropdown div
            const desktopThemeTrigger = document.getElementById('desktop-theme-trigger'); // Button
            const desktopThemeDisplayIcon = document.getElementById('desktop-theme-display-icon'); // Icon in button

            // Mobile theme dropdown elements
            const mobileThemeDropdownContainer = document.getElementById('mobile-theme-dropdown-container'); // This is the .navbar-item.has-dropdown
            const mobileThemeTrigger = document.getElementById('mobile-theme-trigger'); // This is the <a> link trigger
            // Mobile trigger icon is static (fa-cog), does not change with theme.

            function updateTheme(theme) {
                document.documentElement.classList.remove('light-theme', 'dark-theme');
                let newDesktopDisplayIconClass = 'fa-cog'; // Default for desktop trigger's display icon

                if (theme === 'system') {
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        document.documentElement.classList.add('dark-theme');
                    } else {
                        document.documentElement.classList.add('light-theme');
                    }
                    newDesktopDisplayIconClass = 'fa-desktop';
                } else if (theme === 'dark') {
                    document.documentElement.classList.add('dark-theme');
                    newDesktopDisplayIconClass = 'fa-moon';
                } else { // 'light' or any other case
                    document.documentElement.classList.add('light-theme');
                    newDesktopDisplayIconClass = 'fa-sun';
                }
                
                // Update desktop trigger icon
                if(desktopThemeDisplayIcon) {
                    desktopThemeDisplayIcon.className = 'fas ' + newDesktopDisplayIconClass;
                }
                // Mobile trigger icon remains 'fa-cog'

                // Highlight active theme item in all dropdowns
                allThemeItems.forEach(item => {
                    item.classList.toggle('is-active', item.dataset.theme === theme);
                });
                localStorage.setItem('themePreference', theme);
            }

            // Attach click listeners to all theme items (shared by mobile and desktop)
            allThemeItems.forEach(item => {
                item.addEventListener('click', (event) => {
                    event.stopPropagation(); 
                    const newTheme = item.dataset.theme;
                    updateTheme(newTheme);
                    
                    // Close the specific dropdown this item belongs to
                    // For mobile: .navbar-item.has-dropdown.mobile-theme-toggler
                    // For desktop: .theme-dropdown (inside .theme-dropdown-navbar-item)
                    const parentDropdownMobile = item.closest('.mobile-theme-toggler.is-active');
                    const parentDropdownDesktop = item.closest('.theme-dropdown.is-active');

                    if (parentDropdownMobile) {
                        parentDropdownMobile.classList.remove('is-active');
                        const trigger = parentDropdownMobile.querySelector('.mobile-theme-trigger');
                        if(trigger) trigger.setAttribute('aria-expanded', 'false');
                    }
                    if (parentDropdownDesktop) {
                        parentDropdownDesktop.classList.remove('is-active');
                         const trigger = parentDropdownDesktop.querySelector('#desktop-theme-trigger');
                        if(trigger) trigger.setAttribute('aria-expanded', 'false');
                    }
                });
            });

            // Desktop Dropdown Toggle
            if (desktopThemeTrigger && desktopThemeDropdownContainer) {
                desktopThemeTrigger.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Ensure we are on desktop by checking if the parent navbar-item is visible
                    const parentNavbarItem = desktopThemeDropdownContainer.closest('.theme-dropdown-navbar-item');
                    if (parentNavbarItem && getComputedStyle(parentNavbarItem).display !== 'none') {
                        const isActive = desktopThemeDropdownContainer.classList.toggle('is-active');
                        desktopThemeTrigger.setAttribute('aria-expanded', isActive.toString());
                         // Close mobile dropdown if open
                        if (mobileThemeDropdownContainer && mobileThemeDropdownContainer.classList.contains('is-active')) {
                            mobileThemeDropdownContainer.classList.remove('is-active');
                            if(mobileThemeTrigger) mobileThemeTrigger.setAttribute('aria-expanded', 'false');
                        }
                    }
                });
            }

            // Mobile Dropdown Toggle
            if (mobileThemeTrigger && mobileThemeDropdownContainer) {
                mobileThemeTrigger.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Ensure we are on mobile by checking if the container itself is visible
                    // (CSS handles its visibility per breakpoint)
                    if (getComputedStyle(mobileThemeDropdownContainer).display !== 'none') {
                         const isActive = mobileThemeDropdownContainer.classList.toggle('is-active');
                         mobileThemeTrigger.setAttribute('aria-expanded', isActive.toString());
                         // Close desktop dropdown if open
                        if (desktopThemeDropdownContainer && desktopThemeDropdownContainer.classList.contains('is-active')) {
                            desktopThemeDropdownContainer.classList.remove('is-active');
                            if(desktopThemeTrigger) desktopThemeTrigger.setAttribute('aria-expanded', 'false');
                        }
                    }
                });
            }

            // Global click listener to close open dropdowns
            document.addEventListener('click', (event) => {
                // Close desktop dropdown
                if (desktopThemeDropdownContainer && desktopThemeDropdownContainer.classList.contains('is-active') &&
                    desktopThemeTrigger && !desktopThemeTrigger.contains(event.target) &&
                    !desktopThemeDropdownContainer.querySelector('.theme-dropdown-content').contains(event.target)) {
                    desktopThemeDropdownContainer.classList.remove('is-active');
                    desktopThemeTrigger.setAttribute('aria-expanded', 'false');
                }

                // Close mobile dropdown
                if (mobileThemeDropdownContainer && mobileThemeDropdownContainer.classList.contains('is-active') &&
                    mobileThemeTrigger && !mobileThemeTrigger.contains(event.target) &&
                    !mobileThemeDropdownContainer.querySelector('.navbar-dropdown').contains(event.target) ) {
                    mobileThemeDropdownContainer.classList.remove('is-active');
                    mobileThemeTrigger.setAttribute('aria-expanded', 'false');
                }
            });
            
            // Initial theme load - default to 'system' as per Bulma.io docs recommendation
            const savedTheme = localStorage.getItem('themePreference') || 'system'; 
            updateTheme(savedTheme);
            
            // System theme change listener
            if (window.matchMedia) {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                    if (localStorage.getItem('themePreference') === 'system') {
                        updateTheme('system');
                    }
                });
            }
        });
    </script>
</body>
</html>
